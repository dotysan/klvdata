name: CI

on:
  push:
    branches: [ "fireview" ]
  pull_request:
    branches: [ "fireview" ]

# permissions:
#   contents: read

jobs:

#----------------------------------------------------------------------
  tests:
    runs-on: ubuntu-22.04
    strategy:
      # don't fail Python X if Python Y craps the bed
      fail-fast: false
      matrix:
        python-version:
          - "3.7"
          - "3.8"
          - "3.9"
          - "3.10"
          - "3.11"
          - "3.12"

    steps:

    - uses: actions/checkout@v4

    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5
      with:
        python-version: ${{ matrix.python-version }}

    - name: Install dependencies
      run: |
        pip install --upgrade pip setuptools
        pip list
        pip install --requirement requirements/ci.pip
        pip install coveralls
    #     python -m pip install --upgrade pip
    #     python -m pip install flake8 pytest
#         pip install flake8 pytest
#         if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

    - name: Lint with flake8
      run: |
        pip install flake8
        # stop the build if there are Python syntax errors or undefined names
        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide
        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics

    # - name: Run tests and generate documentation
    #   run: |
    #     coverage run -m unittest discover --start-directory test/
    #     cd docs
    #     make html
    #     cd ..
    - name: Run tests
      run: |
        coverage run -m unittest discover --start-directory test/
    # - name: Test with pytest
    #   run: |
    #     pytest

    # - name: Coveralls
    #   run: coveralls

#----------------------------------------------------------------------
  # build-docs:
  #   runs-on: ubuntu-22.04
  #   needs: tests



# os: linux
# dist: xenial
# language: python
# python:
#   - "3.5"
#   - "3.6"
#   - "3.7"
# # Command to install dependencies
# install:
#   - pip install -r requirements/ci.pip
#   - pip install coveralls

# # Command to run tests
# script:
#   - coverage run -m unittest discover --start-directory test/
#   - set -e
#   - cd docs
#   - make html
#   - cd ..
#   - doctr deploy --built-docs docs/_build/html .
# after_success:
#   coveralls
# env:
#   global:
#     - secure: "sY6rUVIOxn4Mt4YieIvUDZToKPMjH4yk6YdVZLHfhmVlZW/st4AKkks+3jTZcNXGhPa8pEopS21FIadXoQ64NDD63F3ZuZNhyHM2Bq2ZfyPB4DcyYa7lasmlJIYWdAHz1bHp3z9YPvyoa4ieTkh+ZJCJ0kWUZF455giuK631OdZ3NBl3ot4Ef4U3rmTXfShRjbDG6u7gwu/n6D8FmAGg0jMgwAGYfrQ3EtPWPzlmdn39nidoYWbh/HFhKBZ+1QFYhj6Yfh4JZkktl0hXCyyDFrPj7Sn+p/+C9+PC+2t+WjkEov1CQd9ZtpjMxH1Y+Cy3KXJBjQknn7Mz5TqX4Rsbp+iU7kJEM7sikL0IriB4dzsShHgf3izRz4V/tivUg5Fv9E0SFIe8TUnqzUeHjv39jCFJf7lPQCtZWiK+KeBo80s/McqtaPxhcM5IgiPyHFExy+GbUzD06H/VlIttIlfzxTQpp5UOqkoDERP9g5PS8aw4R0f8P1OoWQ7uuVjZu/PXK3chqolAUbp1ZVn041LaKuW/ykZ1aCEjyslrD1lZVZ+aizLlVEOtSj9pRcXOKAjfqiM+oMbVymOsOkD1Tb5srx7EWA9MAbTNw8ep0Iid2mr7b8zCnqlFcK8KP8CrNKGu06oeN7JCGfGDArWG+Mkp4o0z2H70USjgWiccr3p38VA="
